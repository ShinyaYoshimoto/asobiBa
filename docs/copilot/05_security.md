# 05_security — セキュリティ / プライバシー指針とコーディング規約

セキュリティ指針
- シークレット管理:
  - API キーやサービスアカウント JSON はコードに含めない。必ず環境変数（.env / GitHub Secrets）を使う。
  - .env.example を用意し、実際の値は含めない
- 個人データ:
  - テストデータに実データを含めない。偽データを明示する
- 外部 API 呼び出し:
  - タイムアウト、リトライ、指数バックオフ、エラーハンドリングを実装する

画像・ファイル処理
- Content-Type と拡張子の両方を検証する
- 不正ファイルの取り扱い（破損ファイル、ウイルス等）を考慮し、例外処理とログ出力を行う
- サムネ生成や変換ではメモリ使用量を見積もり、ストリーミング処理や chunked 処理を検討する

依存関係と CI
- ネイティブモジュール（sharp 等）の扱い: CI の環境差異（Linux / macOS）を明記し、ビルド手順を提供する
- 脆弱性管理: 依存のアップデートは PR で提示し、影響範囲を明示する

開発者向けチェックリスト
- [ ] シークレットを含めていない
- [ ] テストデータに個人情報を含めていない
- [ ] 外部依存のエラーケースをテストしている
- [ ] 大きなファイル処理のメモリ/時間見積りを提示している
